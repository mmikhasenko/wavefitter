// An example of model description

// Basic fit information:
name = "K-matrix 2^{-+} sector";
  
// Data specification:

data = 
{
  path = "~/Dropbox/2+-COMPASS/all_waves_3pi/";
  points = ( 
  /*--------- t range is 0.100000-0.112853 ---------*/ 
  /*------------------------------------------------*/ 
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/abs.h26.out";
                title       = "Intensity of f_{2}#pi S-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 0 */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/abs.h29.out";
                title       = "Intensity of f_{2}#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 1 */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/abs.h33.out";
                title       = "Intensity of #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 2 */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/abs.h36.out";
                title       = "Intensity of #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.1 , 2.4 ];
             }, /* no 3 */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/abs.h40.out";
                title       = "Intensity of #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.1 , 2.4 ];
             }, /* no 4 */

             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4026029.out";
                title       = "Phase difference f_{2}#pi S-wave f_{2}#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 5  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4026033.out";
                title       = "Phase difference f_{2}#pi S-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 6  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4026036.out";
                title       = "Phase difference f_{2}#pi S-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 7  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4026040.out";
                title       = "Phase difference f_{2}#pi S-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 8  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4029033.out";
                title       = "Phase difference f_{2}#pi D-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 9  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4029036.out";
                title       = "Phase difference f_{2}#pi D-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 10  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4029040.out";
                title       = "Phase difference f_{2}#pi D-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 11  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4033036.out";
                title       = "Phase difference #rho#pi P-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 12  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4033040.out";
                title       = "Phase difference #rho#pi P-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 13  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/corrected_phases/phi.rad.h4036040.out";
                title       = "Phase difference #rho#pi F-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.1 , 2.4 ];
             }, /* no 14  */

             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1026029.out";
                title       = "Real part of interference f_{2}#pi S-wave f_{2}#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 15  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1026033.out";
                title       = "Real part of interference f_{2}#pi S-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 16  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1026036.out";
                title       = "Real part of interference f_{2}#pi S-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 17  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1026040.out";
                title       = "Real part of interference f_{2}#pi S-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 18  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1029033.out";
                title       = "Real part of interference f_{2}#pi D-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 19  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1029036.out";
                title       = "Real part of interference f_{2}#pi D-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 20  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1029040.out";
                title       = "Real part of interference f_{2}#pi D-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 21  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1033036.out";
                title       = "Real part of interference #rho#pi P-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 22  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1033040.out";
                title       = "Real part of interference #rho#pi P-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 23  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/real.h1036040.out";
                title       = "Real part of interference #rho#pi F-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.1 , 2.4 ];
             }, /* no 24  */

             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2026029.out";
                title       = "Imag part of interference f_{2}#pi S-wave f_{2}#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 25  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2026033.out";
                title       = "Imag part of interference f_{2}#pi S-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 26  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2026036.out";
                title       = "Imag part of interference f_{2}#pi S-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 27  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2026040.out";
                title       = "Imag part of interference f_{2}#pi S-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.2 , 2.4 ];
             }, /* no 28  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2029033.out";
                title       = "Imag part of interference f_{2}#pi D-wave #rho#pi P-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 29  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2029036.out";
                title       = "Imag part of interference f_{2}#pi D-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 30  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2029040.out";
                title       = "Imag part of interference f_{2}#pi D-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.3 , 2.4 ];
             }, /* no 31  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2033036.out";
                title       = "Imag part of interference #rho#pi P-wave #rho#pi F-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 32  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2033040.out";
                title       = "Imag part of interference #rho#pi P-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.4 , 2.4 ];
             }, /* no 33  */
             {  type        = "txt";
                file_name   = "tprime_0.100000-0.112853/imag.h2036040.out";
                title       = "Imag part of interference #rho#pi F-wave #pi#pi D-wave";
                trust_range = [ 1.0 , 2.5 ];
                  fit_range = [ 1.1 , 2.4 ];
             }  /* no 34  */
            );
};

modelT =
{
  name = "K-matrix";
  channels = ( { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 0;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 2;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 1;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 3;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("pipiS","pi");
                 L = 2;
                 size = 5.; # GeV^{-1}
               }
             );

  content = ( { type = "pole";
                couplings = "g";
                mass = "m0";
              },
              { type = "pole";
                couplings = "h";
                mass = "m1";
              } //,
//              { type = "pole";
//                couplings = "i";
//                mass = "m2";
//              } // ,
//              { type = "pole-like-background";
//                couplings = "bg";
//                mass = "bm0";
//              }
            );
};

modelA = ( {
             scattering = "K-matrix";              // no options, but it can be commented
           
              short_range = { type = "polinomial";  // pietarinen, polinomial
                              powers = ["0c"];  // 0 is power of map variable 
// //                             rhc = 0.1;            // where the RHC starts 
// //                             slope = 1.1;          // parameter of mapping 
                            };

//             long_range = { type = "DeckAJ";       // only one option 
//                            pomeron_S = 1;         // Sp 
//                            pomeron_M = 0;         // lamP = -M 
//                            damping_R = 5.;        // a pole is intruduced at M = 1./R 
//                            pomeron_virtuality = -0.01; // has to be removed, and replaced by proper solution
//                            long_range_lookup = [ "/tmp/t0.deck.2.f2piS.30.out",
//                                                  "/tmp/t0.deck.2.f2piD.30.out",
//                                                  "/tmp/t0.deck.2.rhopiP.30.out",
//                                                  "/tmp/t0.deck.2.rhopiF.30.out",
//                                                  "/tmp/t0.deck.2.pipiSpiD.30.out" ];
//                          };
//             unitarisation = "DoIt";
           }
);

adjustment = {
  relation = (
                  /* intensities */
                  (0, "I@", [0,0]),
                  (1, "I@", [0,1]),
                  (2, "I@", [0,2]),
                  (3, "I@", [0,3]),
                  (4, "I@", [0,4]),
                  
                  /*  Phi@  applied to interference term */
                  (5, "Phi@", ([0,1], [0,0]) ),
                  (6, "Phi@", ([0,2], [0,0]) ),
                  (7, "Phi@", ([0,3], [0,0]) ),
                  (8, "Phi@", ([0,4], [0,0]) ),
                  (9, "Phi@", ([0,2], [0,1]) ),
                  (10, "Phi@", ([0,3], [0,1]) ),
                  (11, "Phi@", ([0,4], [0,1]) ),
                  (12, "Phi@", ([0,3], [0,2]) ),
                  (13, "Phi@", ([0,4], [0,2]) ),
                  (14, "Phi@", ([0,4], [0,3]) ),
                  
                  /*  ReInterf@  applied to interference term */
                  (15, "ReInterf@", ([0,1], [0,0]) ),
                  (16, "ReInterf@", ([0,2], [0,0]) ),
                  (17, "ReInterf@", ([0,3], [0,0]) ),
                  (18, "ReInterf@", ([0,4], [0,0]) ),
                  (19, "ReInterf@", ([0,2], [0,1]) ),
                  (20, "ReInterf@", ([0,3], [0,1]) ),
                  (21, "ReInterf@", ([0,4], [0,1]) ),
                  (22, "ReInterf@", ([0,3], [0,2]) ),
                  (23, "ReInterf@", ([0,4], [0,2]) ),
                  (24, "ReInterf@", ([0,4], [0,3]) ),
                  
                  /*  ImInterf@  applied to interference term */
                  (25, "ImInterf@", ([0,1], [0,0]) ),
                  (26, "ImInterf@", ([0,2], [0,0]) ),
                  (27, "ImInterf@", ([0,3], [0,0]) ),
                  (28, "ImInterf@", ([0,4], [0,0]) ),
                  (29, "ImInterf@", ([0,2], [0,1]) ),
                  (30, "ImInterf@", ([0,3], [0,1]) ),
                  (31, "ImInterf@", ([0,4], [0,1]) ),
                  (32, "ImInterf@", ([0,3], [0,2]) ),
                  (33, "ImInterf@", ([0,4], [0,2]) ),
                  (34, "ImInterf@", ([0,4], [0,3]) )
             );
};

parameters = {
  start_value = ( /* First pole */
                 ("m0", 1.721, 1.601, 1.801),
                 ("g0", 4.1, -10., 10.),
                 ("g1", 1.0, -10., 10.),
                 ("g2", 5.0, -10., 10.),
                 ("g3", 3.5, -10., 10.),
                 ("g4", 3.0, -10., 10.),
                 /* Second pole */
                 ("m1", 1.831, 1.801, 2.051),
                 ("h0", 1. , -10., 10.),
                 ("h1", 3. , -10., 10.),
                 ("h2", 6.0, -10., 10.),
                 ("h3", 2.0, -10., 10.),
                 ("h4", 2.0, -10., 10.),
//                 /* Third pole */
//                  ("m2", 2.151, 2.051, 2.301),
//                  ("i0", 3.0, -10., 10.),
//                  ("i1", 3.0, -10., 10.),
//                  ("i2", 3.0, -10., 10.),
//                  ("i3", 3.0, -10., 10.),
//                  ("i4", 0.0, -10., 10.),
                 /* Production constants */
                 ("0cr0",  30., -40., 40.),
                 ("0cr1",  5. , -40., 40.),
                 ("0cr2",  0. , -40., 40.),
                 ("0cr3",  10., -40., 40.),
                 ("0cr4",  10., -40., 40.),
                 /* Imaginary part of production constants */
                 ("0ci0", 0., -10., 10.),
                 ("0ci1", 0., -10., 10.),
                 ("0ci2", 0., -10., 10.),
                 ("0ci3", 0., -10., 10.),
                 ("0ci4", 0., -10., 10.)
//                  /* Background */
//                  ("Br", 1., -10., 10.),
//                  ("Bi", 0., -10., 10.)
                );
};

// fit_settings = {
//   nAttempts = 1 ;
//   save_preview = "yes";
//   seed = 11;
//   strategy = ( { relations_to_fit = [ 0, 1, 2, 3, 4, // intensities
//                                       15, 19, 23, 24,  // re
//                                       25, 29, 33, 34]; // im
//                  pars_to_vary = ["m0",  "g0",  "g1",  "g2",  "g3",  "g4",
//                                  "m1",  "h0",  "h1",  "h2",  "h3",  "h4",
// //                                 "m2",  "i0",  "i1",  "i2",  "i3",  "i4",
// //                                 "bm0", "bg0", "bg1", "bg2", "bg3", "bg4",
// 
// //                                       "0cr0", "0cr1", "0cr2", "0cr3", "0cr4",
// //                                       "0ci0", "0ci1", "0ci2", "0ci3", "0ci4"
// //                                                           "Br",  "Bi"
//                                  ];
//                }
//              );
//   dout_name = "/tmp/fit.status.test/";
// };


plot_settings = {
  //path_to_fit_results = "/localhome/mikhasenko/Public/K-matrix/fit.4intensities.3phases.with.unitarized.deck/fit.results.all.phases.500att.root";
  //entry_fit_result = 11;

  type = "model"; /* model &| data */
  mapping = (  (0),  (5),  (6),  (7),  (8), /*numner of relation to plot*/
                (),  (1),  (9), (10), (11),
                (),   (),  (2), (12), (13),
                (),   (),   (),  (3), (14),
                (),   (),   (),   (),  (4)
            );
//   mapping_list = ( ( (0),  (5),  (6),  (7),  (8),
//                       (),  (1),  (9), (10), (11),
//                       (),   (),  (2), (12), (13),
//                       (),   (),   (),  (3), (14),
//                       (),   (),   (),   (),  (4)
//                    ),
//                    ( (0),  (5),  (6),  (7),  (8),
//                       (),  (1),  (9), (10), (11),
//                       (),   (),  (2), (12), (13),
//                       (),   (),   (),  (3), (14),
//                       (),   (),   (),   (),  (4)
//                    ),
//                    ( (0),  (5),  (6),  (7),  (8),
//                       (),  (1),  (9), (10), (11),
//                       (),   (),  (2), (12), (13),
//                       (),   (),   (),  (3), (14),
//                       (),   (),   (),   (),  (4)
//                    )
//                  );     
  what_to_plot = ( { title = "Model";
                     set_to_zero = ();
                     color = 2;
                   },
//                    { title = "Deck projection";
//                      set_to_zero = ("g0","g1","g2","g3","g4","h0","h1","h2","h3","h4"); //,"i0","i1","i2","i3","i4"
//                      color = 8;
//                      mapping_elements = (0, 6, 12, 18, 24);
//                    }  // ,
                   { title = "Pole no.1";
                     set_to_zero = ("h0","h1","h2","h3","h4"); //,"i0","i1","i2","i3","i4", "Br","Bi",
                     color = 38;
                     mapping_elements = (0, 6, 12, 18, 24);
                   },
                   { title = "Pole no.2";
                     set_to_zero = ("g0","g1","g2","g3","g4"); //,"i0","i1","i2","i3","i4", "Br","Bi",
                     color = 39;
                     mapping_elements = (0, 6, 12, 18, 24);
                   } //,
//                   { title = "Pole no.3";
//                     set_to_zero = ("g0","g1","g2","g3","g4","h0","h1","h2","h3","h4"); // "Br","Bi",
//                     color = 40;
//                     mapping_elements = (0, 6, 12, 18, 24);
//                   }
                 )
  fplot_name = "/tmp/default_plot.read_model_settings.pdf";
};

// continuation_settings = {
// //  path_to_fit_results = "/localhome/mikhasenko/Public/K-matrix/fit.4intensities.3phases.with.unitarized.deck/fit.results.all.phases.500att.root";
// //  entry_fit_result = 11;
//   
//   // value_to_plot = "amplitude";
//   what_to_plot = "first sheet & second sheet";
//   plot_range = { real_range = (50,  1.2, 4.5);
//                  imag_range = (50, -1.5, 1.5 );
//                };
//   fplot_name = "/tmp/continuation_plot.mymodel.read_model_settings.pdf";
// }; 
