// An example of model description

// Basic fit information:
name = "K-matrix 2^{-+} sector";
  
// Data specification:

data = 
{
  path = "~/Dropbox/2+-COMPASS/all_waves_3pi/tprime_0.100000-0.112853/";
  points = ( {  type        = "txt";
                file_name   = "abs.h26.out";
                title       = "Intensity f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,2.4);
             } /* no 0 */,
             {  type        = "txt";
                file_name   = "abs.h29.out";
                title       = "Intensity f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.4);
             } /* no 1 */,
             {  type        = "txt";
                file_name   = "abs.h33.out";
                title       = "Intensity #rho#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,2.4);
             } /* no 2 */,
             {  type        = "txt";
                file_name   = "abs.h36.out";
                title       = "Intensity #rho#pi F-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.1,2.4);
             } /* no 3 */,
             
             /* Relative phases */
             {  type        = "txt";
                file_name   = "corrected_phases/phi.rad.h4026029.out";
                title       = "Phase difference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.5,2.4);
             } /* no 4 */,
             {  type        = "txt";
                file_name   = "corrected_phases/phi.rad.h4026033.out";
                title       = "Phase difference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.4,2.5);
                fit_range   = (1.4,2.1);
             } /* no 5 */,
             {  type        = "txt";
                file_name   = "corrected_phases/phi.rad.h4026036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 6 */,
             {  type        = "txt";
                file_name   = "corrected_phases/phi.rad.h4029033.out";
                title       = "Phase difference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 7 */,
             {  type        = "txt";
                file_name   = "corrected_phases/phi.rad.h4029036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 8 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4033036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,2.1);
             } /* no 9 */,
             
             /* Re of relative phases */
             {  type        = "txt"
                file_name   = "real.h1026029.out";
                title       = "Real part of interference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.5,2.4);
             } /* no 10 */,
             {  type        = "txt"
                file_name   = "real.h1026033.out";
                title       = "Real part of interference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.4,2.5);
                fit_range   = (1.4,2.1);
             } /* no 11 */,
             {  type        = "txt"
                file_name   = "real.h1026036.out";
                title       = "Real part of interference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 12 */,
             {  type        = "txt"
                file_name   = "real.h1029033.out";
                title       = "Real part of interference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 13 */,
             {  type        = "txt"
                file_name   = "real.h1029036.out";
                title       = "Real part of interference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 14 */,
             {  type        = "txt";
                file_name   = "real.h1033036.out";
                title       = "Real part of interference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,2.1);
             } /* no 15 */,
             
             /* Imag of interference */
             {  type        = "txt";
                file_name   = "imag.h2026029.out";
                title       = "Imag part of interference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.5,2.4);
             } /* no 16 */,
             {  type        = "txt";
                file_name   = "imag.h2026033.out";
                title       = "Imag part of interference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.4,2.5);
                fit_range   = (1.4,2.1);
             } /* no 17 */,
             {  type        = "txt";
                file_name   = "imag.h2026036.out";
                title       = "Imag part of interference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 18 */,
             {  type        = "txt";
                file_name   = "imag.h2029033.out";
                title       = "Imag part of interference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 19 */,
             {  type        = "txt";
                file_name   = "imag.h2029036.out";
                title       = "Imag part of interference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.6,2.2);
             } /* no 20 */,
             {  type        = "txt";
                file_name   = "imag.h2033036.out";
                title       = "Imag part of interference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,2.1);
             } /* no 21 */
         );
};


modelT =
{
  name = "K-matrix";
  channels = ( { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 0;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 2;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 1;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 3;
                 size = 5.; # GeV^{-1}
               }
             );

  content = ( { type = "pole";
                couplings = "g";
                mass = "m0";
              },
              { type = "pole";
                couplings = "h";
                mass = "m1";
              },
              { type = "pole";
                couplings = "i";
                mass = "m2";
              }
            );
};

modelA = ( {
             scattering = "K-matrix";              // no options, but it can be commented
           
             short_range = { type = "pietarinen";  // only one option 
                             powers = ((0, "c"));  // 0 is power of map variable 
                             rhc = 0.1;            // where the RHC starts 
                             slope = 1.1;          // parameter of mapping 
                           };
           
             long_range = { type = "Deck";         // only one option 
                            pomeron_S = 1;         // Sp 
                            pomeron_M = 0;         // lamP = -M 
                            damping_R = 5.;        // a pole is intruduced at M = 1./R 
                            pomeron_virtuality = -0.01; // has to be removed, and replaced by proper solution
                            long_range_lookup = [ "/tmp/t0.deck.2.f2piS.30.out",
                                                  "/tmp/t0.deck.2.f2piD.30.out",
                                                  "/tmp/t0.deck.2.rhopiP.30.out",
                                                  "/tmp/t0.deck.2.rhopiF.30.out" ];
                          };

             unitarisation = "DoIt";
           }
);

adjustment = {
  relation = ( /* intensities */          // no relation
               (0, "I@", [0,0]),              //  0)
               (1, "I@", [0,1]),              //  1)
               (2, "I@", [0,2]),              //  2)
               (3, "I@", [0,3]),              //  3)

               /* phase difference */
               (4, "Phi@", ([0,1], [0,0])),       //  4)
               (5, "Phi@", ([0,2], [0,0])),       //  5)
               (6, "Phi@", ([0,3], [0,0])),       //  6)
               (7, "Phi@", ([0,2], [0,1])),       //  7)
               (8, "Phi@", ([0,3], [0,1])),       //  8)
               (9, "Phi@", ([0,3], [0,2])),       //  9)

               /* sin phase difference */
               (10, "ReInterf@", ([0,1], [0,0])),   // 10)
               (11, "ReInterf@", ([0,2], [0,0])),   // 11)
               (12, "ReInterf@", ([0,3], [0,0])),   // 12)
               (13, "ReInterf@", ([0,2], [0,1])),   // 13)
               (14, "ReInterf@", ([0,3], [0,1])),   // 14)
               (15, "ReInterf@", ([0,3], [0,2])),   // 15)

               /* cos phase difference */
               (16, "ImInterf@", ([0,1], [0,0])),   // 16)
               (17, "ImInterf@", ([0,2], [0,0])),   // 17)
               (18, "ImInterf@", ([0,3], [0,0])),   // 18)
               (19, "ImInterf@", ([0,2], [0,1])),   // 19)
               (20, "ImInterf@", ([0,3], [0,1])),   // 20)
               (21, "ImInterf@", ([0,3], [0,2]))    // 21)
             );
};

parameters = {
  start_value = ( /* First pole */
                  ("m0", 1.721, 1.601, 1.801),
                  ("g0", 3.1, -10., 10.),
                  ("g1", 0.0, -10., 10.),
                  ("g2", 3.0, -10., 10.),
                  ("g3", 2.5, -10., 10.),
                  /* Second pole */
                  ("m1", 1.831, 1.801, 2.051),
                  ("h0", 1. , -10., 10.),
                  ("h1", 3. , -10., 10.),
                  ("h2", 0.0, -10., 10.),
                  ("h3", 2.0, -10., 10.),
                  /* Third pole */
                  ("m2", 2.151, 2.051, 2.301),
                  ("i0", 3.0, -10., 10.),
                  ("i1", 3.0, -10., 10.),
                  ("i2", 3.0, -10., 10.),
                  ("i3", 3.0, -10., 10.),
                  /* Production constants */
                  ("cr0",  30., -40., 40.),
                  ("cr1",  5. , -40., 40.),
                  ("cr2",  0. , -40., 40.),
                  ("cr3",  10., -40., 40.),
                  /* Imaginary part of production constants */
                  ("ci0", 0., -10., 10.),
                  ("ci1", 0., -10., 10.),
                  ("ci2", 0., -10., 10.),
                  ("ci3", 0., -10., 10.),
                  /* Background */
                  ("Br", 1., -10., 10.),
                  ("Bi", 0., -10., 10.)
                );
};

fit_settings = {
  nAttempts = 100;
  strategy = ( { relations_to_fit = ( 0, 1, 2, 3,  // intensities
                                      10, 11, 12, 13, 14, 15,  // re
                                      16, 17, 18, 19, 20, 21); // im
                 pars_to_vary = ("m0", "g0" , "g1" , "g2" , "g3",
                                 "m1", "h0" , "h1" , "h2" , "h3",
                                 "m2", "i0" , "i1" , "i2" , "i3",
                                       "cr0", "cr1", "cr2", "cr3",
                                       "ci0", "ci1", "ci2", "ci3",
                                                      "Br",  "Bi" );
               }
             );
  dout_name = "/tmp/fit.t0.re-im/";
};
//
//
//plot_settings = {
//  path_to_fit_results = "/localhome/mikhasenko/Public/K-matrix/fit.4intensities.3phases.with.unitarized.deck/fit.results.all.phases.500att.root";
//  entry_fit_result = 11;
//
//  type = "model data"; /* model &| data */
//  mapping = (  (0), (10), (11), (12), /*numner of relation to plot*/
//              (16),  (1), (13), (14),
//              (17), (19),  (2), (15),
//              (18), (20), (21),  (3)
//            );
//  what_to_plot = ( { title = "Model";
//                     set_to_zero = ();
//                     color = 2;
//                   },
//                   { title = "Deck projection";
//                     set_to_zero = ("g1","g1","g2","g3","h0","h1","h2","h3","i0","i1","i2","i3");
//                     color = 8;
//                     mapping_elements = (0, 5, 10, 15);
//                   },
//                   { title = "Pole no.1";
//                     set_to_zero = ("Br","Bi","h0","h1","h2","h3","i0","i1","i2","i3");
//                     color = 9;
//                     mapping_elements = (0, 5, 10, 15);
//                   },
//                   { title = "Pole no.2";
//                     set_to_zero = ("Br","Bi","g0","g1","g2","g3","i0","i1","i2","i3");
//                     color = 9;
//                     mapping_elements = (0, 5, 10, 15);
//                   },
//                   { title = "Pole no.3";
//                     set_to_zero = ("Br","Bi","g0","g1","g2","g3","h0","h1","h2","h3");
//                     color = 9;
//                     mapping_elements = (0, 5, 10, 15);
//                   }
//                 )
//  fplot_name = "/tmp/default_plot.read_model_settings.pdf";
//}; 
