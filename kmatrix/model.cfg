// An example of model description

// Basic fit information:
name = "K-matrix 2^{-+} sector";
  
// Data specification:

data = 
{
  path = "~/Dropbox/2+-COMPASS/all_waves_3pi/tprime_0.100000-0.112853/";
  points = ( {  type        = "txt"
                file_name   = "abs.h26.out";
                title       = "Intensity f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.8);
             } /* no 0 */,
             {  type        = "txt"
                file_name   = "abs.h29.out";
                title       = "Intensity f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.1);
             } /* no 1 */,
             {  type        = "txt"
                file_name   = "abs.h33.out";
                title       = "Intensity #rho#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,2.0);
             } /* no 2 */,
             {  type        = "txt"
                file_name   = "abs.h36.out";
                title       = "Intensity #rho#pi F-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.1,1.9);
             } /* no 3 */,
             
             /* Relative phases */
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4026029.out";
                title       = "Phase difference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 4 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4026033.out";
                title       = "Phase difference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 5 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4026036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 6 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4029033.out";
                title       = "Phase difference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.0);
             } /* no 7 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4029036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,1.9);
             } /* no 8 */,
             {  type        = "txt"
                file_name   = "corrected_phases/phi.rad.h4033036.out";
                title       = "Phase difference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 9 */,
             
             /* Sin of relative phases */
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4026029.out";
                title       = "Sin of phase difference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 10 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4026033.out";
                title       = "Sin of phase difference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 11 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4026036.out";
                title       = "Sin of phase difference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 12 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4029033.out";
                title       = "Sin of phase difference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.0);
             } /* no 13 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4029036.out";
                title       = "Sin of phase difference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,1.9);
             } /* no 14 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/sin.h4033036.out";
                title       = "Sin of phase difference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 15 */,
             
             /* Cos of relative phases */
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4026029.out";
                title       = "Cos of phase difference f_{2}#pi D-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 16 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4026033.out";
                title       = "Cos of phase difference #rho#pi P-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.2);
             } /* no 17 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4026036.out";
                title       = "Cos of phase difference #rho#pi F-wave - f_{2}#pi S-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 18 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4029033.out";
                title       = "Cos of phase difference #rho#pi P-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.3,2.0);
             } /* no 19 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4029036.out";
                title       = "Cos of phase difference #rho#pi F-wave - f_{2}#pi D-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.4,1.9);
             } /* no 20 */,
             {  type        = "txt"
                file_name   = "sincos_of_phases/cos.h4033036.out";
                title       = "Cos of phase difference #rho#pi F-wave - f_{2}#pi P-wave";
                trust_range = (1.0,2.5);
                fit_range   = (1.2,1.9);
             } /* no 21 */
         );
};


modelT =
{
  name = "K-matrix";
  channels = ( { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 0;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("f2","pi");
                 L = 2;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 1;
                 size = 5.; # GeV^{-1}
               },
               { type = "quasi-two-body";
                 particles = ("rho","pi");
                 L = 3;
                 size = 5.; # GeV^{-1}
               }
             );

  content = ( { type = "pole";
                couplings = "g";
                mass = "m1";
              },
              { type = "pole";
                couplings = "h";
                mass = "m2";
              }
            );
};


adjustment = {
  relation = ( /* intensities */          // no relation
               (0, "I@", 0),              //  0)
               (1, "I@", 1),              //  1)
               (2, "I@", 2),              //  2)
               (3, "I@", 3),              //  3)

               /* phase difference */
               (4, "Phi@", (1, 0)),       //  4)
               (5, "Phi@", (2, 0)),       //  5)
               (6, "Phi@", (3, 0)),       //  6)
               (7, "Phi@", (2, 1)),       //  7)
               (8, "Phi@", (3, 1)),       //  8)
               (9, "Phi@", (3, 2)),       //  9)

               /* sin phase difference */
               (10, "SinPhi@", (1, 0)),   // 10)
               (11, "SinPhi@", (2, 0)),   // 11)
               (12, "SinPhi@", (3, 0)),   // 12)
               (13, "SinPhi@", (2, 1)),   // 13)
               (14, "SinPhi@", (3, 1)),   // 14)
               (15, "SinPhi@", (3, 2)),   // 15)

               /* cos phase difference */
               (16, "CosPhi@", (1, 0)),   // 16)
               (17, "CosPhi@", (2, 0)),   // 17)
               (18, "CosPhi@", (3, 0)),   // 18)
               (19, "CosPhi@", (2, 1)),   // 19)
               (20, "CosPhi@", (3, 1)),   // 20)
               (21, "CosPhi@", (3, 2))    // 21)
             );
};


parameters = {
  start_value = ( /* First pole */
                  ("m0", 1.721, 1.601, 1.801),
                  ("g0", 3.1, -10., 10.),
                  ("g1", 0.0, -10., 10.),
                  ("g2", 3.0, -10., 10.),
                  ("g3", 2.5, -10., 10.),
                  /* Second pole */
                  ("m1", 1.831, 1.801, 2.201),
                  ("h0", 1. , -10., 10.),
                  ("h1", 3. , -10., 10.),
                  ("h2", 0.0, -10., 10.),
                  ("h3", 2.0, -10., 10.),
                  /* Production constants */
                  ("c0",  30., -40., 40.),
                  ("c1",  5. , -40., 40.),
                  ("c2",  0. , -40., 40.),
                  ("c3",  10., -40., 40.),
                  /* Imaginary part of production constants */
                  ("ic0", 0., -10., 10.),
                  ("ic1", 0., -10., 10.),
                  ("ic2", 0., -10., 10.),
                  ("ic3", 0., -10., 10.)
                );
};


fit_settings = {
  nAttempts = 300;
  strategy = ( { relations_to_fit = (0, 1, 2, 3, 10, 16, 12, 18);
                 pars_to_vary = ("m0", "g0" , "g1" , "g2" , "g3",
                                 "m1", "h0" , "h1" , "h2" , "h3",
                                       "c0" , "c1" , "c2" , "c3",
                                       "ic0", "ic1", "ic2", "ic3" );
               }
             )
};
